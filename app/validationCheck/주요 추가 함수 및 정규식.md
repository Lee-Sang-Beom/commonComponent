### 1. Utils 요소 (문자열 중간에 하이픈 추가 및 제거)

#### 1. `insertHyphenToString()`

- TYPE에 따라 적절한 위치에 하이픈(-)을 넣은 새로운 문자열을 반환하는 함수
  - type : 사업자등록번호(BRNO), 전화번호(TELNO), 날짜(DATE)
  - baseString : 변경을 원하는 기존 문자열
  - incomingMomentDateType : moment 라이브러리에서 baseString이 어떤 타입의 날짜 형식을 가지고 있는 상태인지를 알려주는 포맷
  - outcomingMomentDateType : moment 라이브러리에서 baseString이 어떤 타입의 날짜 형식을 리턴해야하는지를 알려주는 포맷

#### 2. `removeHyphenToString()`

- 하이픈을 모두 빼버리는 함수 (빈 문자열이면 빈 문자열 반환)
  - baseString : 변경을 원하는 기존 문자열

---

### 2. 유효성 체크 (react-hook-form option)

- 참고: required가 없으면 필수값으로 인지하지 않음

  - 이 때, 필수사항은 아니더라도 입력된 순간부터 포맷이 잘못되면 계속 진행하지 못하도록 개발됨

- 유효성 체크와 하이픈 추가 메소드를 동시에 사용하면, 함수 호출만으로 전화번호, 사업자등록번호 등의 replace작업을 끝낼 수 있다.

> before

```tsx
<Input
  size={"lg"}
  id={"brno_input"}
  value={watch("brno").replace(/(\d{3})(\d{2})(\d{5})/, "$1-$2-$3")}
  labelTitle={"사업자등록번호"}
  {...register("brno", {
    required: "사업자등록번호를 입력해주세요.",
    minLength: {
      value: 12,
      message: "10자리를 입력해주세요.",
    },
    maxLength: {
      value: 12,
      message: "10자리를 입력해주세요.",
    },
    validate: {
      startsWith: (v: string) => {
        let result = false;
        let numberMap = v
          .replace(/-/gi, "")
          .split("")
          .map(function (d) {
            return parseInt(d, 10);
          });
        let keyArr = [1, 3, 7, 1, 3, 7, 1, 3, 5];
        let chk = 0;
        keyArr.forEach(function (d, i) {
          chk += d * numberMap[i];
        });
        chk += (keyArr[8] * numberMap[8]) / 10;
        if (numberMap[9] === (10 - Math.floor(chk % 10)) % 10) {
          result = true;
        }
        return result || "유효한 사업자등록번호가 아닙니다.";
      },
    },
  })}
  onChange={async (e) => {
    const value = e.currentTarget.value
      .replaceAll("-", "")
      .replace(/[^0-9]/g, "");
    setValue("brno", value);
    await trigger("brno");
  }}
  onBlur={async (e) => {
    register("brno").onBlur(e);
    await trigger("brno");
  }}
  effectivenessMsg={
    errors.brno
      ? {
          isSuccess: false,
          msg: errors.brno.message!,
        }
      : {
          isSuccess: true,
          msg: "",
        }
  }
/>
```

> after

```tsx
<div>
  <label htmlFor="brno">사업자 등록번호</label>
  <input
    {...register("brno", brnoReactHookFormOption(true))}
    id="brno"
    type="text"
    aria-invalid={isSubmitted ? (errors.brno ? "true" : "false") : undefined}
    value={insertHyphenToString("BRNO", watch("brno") || "")}
    onChange={(e) => {
      setValue("brno", removeHyphenToString(e.currentTarget.value), {
        shouldValidate: true,
      });
    }}
  />
  {errors.brno && <small role="alert">{errors.brno.message}</small>}
</div>
```

#### 1. `phoneNumberReactHookFormOption()`

- 휴대폰 번호에 대한 register() 함수의 두 번째 인자를 반환하는 함수
  - required : 필수 입력사항인지 true, false를 보내면 됨

#### 2. `regionNumberReactHookFormOption()`

- 지역 전화 번호에 대한 register() 함수의 두 번째 인자를 반환하는 함수
  - required : 필수 입력사항인지 true, false를 보내면 됨

#### 3. `commonNumberReactHookFormOption()`

- 휴대폰 + 지역 공통 번호에 대한 register() 함수의 두 번째 인자를 반환하는 함수
  - required : 필수 입력사항인지 true, false를 보내면 됨
  - 공통번호같은게 왜 필요하냐는 상식적 의문이 들 수도 있는데, 당장에 gncar에서 사태가 발생함

#### 4. `emailReactHookFormOption()`

- 이메일에 대한 register() 함수의 두 번째 인자를 반환하는 함수
  - required : 필수 입력사항인지 true, false를 보내면 됨
  - minLength : 입력값의 최소 허용 길이
  - maxLength : 입력값의 최대 허용 길이

#### 5. `passwordReactHookFormOption()`

- 패스워드에 대한 register() 함수의 두 번째 인자를 반환하는 함수
  - required : 필수 입력사항인지 true, false를 보내면 됨
  - minLength : 입력값의 최소 허용 길이
  - maxLength : 입력값의 최대 허용 길이

#### 6. `passwordConfirmReactHookFormOption()`

- 패스워드 확인에 대한 register() 함수의 두 번째 인자를 반환하는 함수

  - pw : 비교 대상. 반드시 특정 시점이 아닌 최신 시점의 값을 불러와야 작동함 (당연)
  - required : 필수 입력사항인지 true, false를 보내면 됨

- 이를 사용할 때, 반드시 useEffect에서 pw가 변경될 때마다, pwConfirm setValue를 진행해주어야 함
  - pw input에 대한 onChange() 메소드를 사용하는 경우에는, 한 차례 늦게 유효성검사를 실행하기 때문임

#### 7. `brnoReactHookFormOption()`

- 사업자등록 번호에 대한 register() 함수의 두 번째 인자를 반환하는 함수
  - required : 필수 입력사항인지 true, false를 보내면 됨

---

### 3. 정규식

- 유효성 체크 대상 과정에서 정규식이 잘못된 것이 있거나, 수정해야 할 것이 있으면 `regex.ts`파일 요소만 수정하면 됨

```ts
/**
 * @phoneNumberRegex : 휴대폰번호 유효성체크
 * @regionNumberRegex : 지역전화번호 유효성체크
 * @phoneAndRegionCommonNumberRegex : 공통 번호 유효성체크
 */
export const phoneNumberRegex = /^(01[016789]{1})[0-9]{3,4}[0-9]{4}$/;
export const regionNumberRegex =
  /^(0(2|3[1-3]|4[1-4]|5[1-5]|6[1-4]))(\d{3,4})(\d{4})$/;
export const phoneAndRegionCommonNumberRegex = /^[0-9]{2,3}[0-9]{3,4}[0-9]{4}$/;

/**
 * @emailRegex : 이메일 유효성체크
 * @passwordRegex : 패스워드 유효성 체크 (영문, 숫자, 특수문자 혼용 9~20자리)
 */
export const emailRegex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i;
export const passwordRegex =
  /^(?=.*[0-9])(?=.*[a-z])(?=.*[`~!@@#$%^&*|₩₩₩'₩";:₩/?])[a-zA-Z0-9`~!@@#$%^&*|₩₩₩'₩";:₩/?]{9,20}$/;
```
